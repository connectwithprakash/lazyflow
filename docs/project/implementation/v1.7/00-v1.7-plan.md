# v1.7 Implementation Plan

## Overview

v1.7 focuses on enhancing the Morning Briefing and Daily Summary features with AI learning context, user feedback tracking, and improved notification handling.

## Issues in Milestone

| # | Issue | Status | Priority | Spec |
|---|-------|--------|----------|------|
| #165 | fix: Prevent preload from suppressing Daily Summary prompt | CLOSED | P0 | [01](./01-fix-preload-daily-summary-prompt-165.md) |
| #168 | feat: Add Morning Briefing prompt toggle | CLOSED | P0 | [02](./02-morning-briefing-prompt-toggle-168.md) |
| #166 | feat: Add calendar context to Morning Briefing | IN REVIEW | P1 | [03](./03-calendar-context-morning-briefing-166.md) |
| #162 | feat: Inject AI learning context into prompts | OPEN | P1 | [04](./04-ai-context-in-briefing-summary-162.md) |
| #163 | feat: Track AI impressions | OPEN | P1 | [05](./05-ai-impressions-briefing-summary-163.md) |
| #164 | feat: Add Regenerate AI actions | OPEN | P2 | [06](./06-regenerate-ai-briefing-summary-164.md) |
| #167 | feat: Handle notification actions | OPEN | P2 | [07](./07-notification-actions-briefing-summary-167.md) |

> **Note:** #41, #43 moved to v1.8. #152 moved to v2.0.

## Dependency Graph

```
#165 (DONE) ──┐
#168 (DONE) ──┴──> #166 (PR #174) ──> #162 ──> #163 ──> #164 ──> #167
```

## Implementation Order

### Phase 1: Foundation (Completed)
- [x] #165 - Fix preload suppression
- [x] #168 - Morning Briefing prompt toggle

### Phase 2: Calendar Context
- [ ] #166 - Calendar context in Morning Briefing (PR #174 in review)

### Phase 3: AI Learning Integration
- [ ] #162 - AI context injection
- [ ] #163 - Track AI impressions

### Phase 4: User Actions
- [ ] #164 - Regenerate AI actions
- [ ] #167 - Notification action handling

## Key Services

| Service | Purpose | Issues |
|---------|---------|--------|
| DailySummaryService | Summary generation, streaks | #165, #166, #162, #163, #164 |
| CalendarService | Event fetching, schedule analysis | #166 |
| AIContextService | User learning data for prompts | #162 |
| AILearningService | Correction patterns, accuracy | #162, #163 |
| NotificationService | Briefing/summary notifications | #167 |

## Success Metrics

| Metric | Target |
|--------|--------|
| Morning Briefing engagement rate | > 60% |
| AI regeneration usage | < 20% |
| Notification action response rate | > 40% |

## Technical Constraints

- All AI learning happens on-device (privacy-first)
- Token budget for AI context: 1500 characters max
- Quality threshold for context inclusion: 0.2
- CloudKit sync for cross-device data
